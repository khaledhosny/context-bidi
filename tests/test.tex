\input luaotfload.sty
\input luabidi
\textdir TRT
\pardir TRT
\directlua{ bidi.maindir = "r2l" }

\font\test={name:DejaVu Sans:mode=node;script=arab} at 10pt \test
\def\TEST{أَبْجَدْ () هَوَّزْ ab(.)cd حُطِّي g كَلَمُنْ ١٢,٣٤٥ سَعْفَصْ قَرَشَتْ 12.345\%\%\$. }
\def\lre{\char"202A}
\def\rle{\char"202B}
\def\lro{\char"202D}
\def\rlo{\char"202E}
\def\pdf{\char"202C}
\def\LRE#1{{\lre #1\pdf}} % or {{\textdir TLT #1}}
\def\RLE#1{{\rle #1\pdf}} % or {{\textdir TRT #1}}
\def\LRO#1{{\lro #1\pdf}}
\def\RLO#1{{\rlo #1\pdf}}

\iffalse
  \tracingoutput=1
  \tracingonline=1
  \showboxdepth=\maxdimen
  \showboxbreadth=\maxdimen
\fi

\TEST

أبجد () هوز ab()cd حطي g كلمن {\textdir TRT ١٢٣٤٥} سعفص {\textdir TLT قرشت}\%a\$.

أبجد () هوز ab()cd حطي g كلمن \RLE{١٢٣٤٥} سعفص \LRE{قرشت}\%a\$.

نص عربي \LRE{before عربي after} عربي

نص عربي before عربي after عربي

نص عربي \LRE{before \LRO{عربي} after} عربي

نص عربي \LRE{before \RLE{قبل english بعد} after} عربي\footnote{$^{123}$}{\TEST}.

$$
123+123 = (123)
$$

\halign{\hfil\it # & # \hfil\cr 3 cl & \TEST\cr}

\bye
